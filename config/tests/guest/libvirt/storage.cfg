include tests-shared.cfg
username = root
password = 123456
main_vm = virt-tests-vm1
vms = virt-tests-vm1
#Network
nettype = bridge
netdst=virbr0
# Using Text mode of installation
display = 'nographic'
take_regular_screendumps = no
keep_screendumps_on_error = no
keep_screendumps = no
store_vm_register = no
virt_install_binary = /usr/bin/virt-install
qemu_img_binary = /usr/bin/qemu-img
hvm_or_pv = hvm
machine_type = pseries
only bridge
no xen, lxc, esx, ovmf
#Filterout unwanted disk types
no ide,xenblk,lsi_scsi,ahci,sd
no qed,qcow2v3,raw_dd,vmdk, usb2
no e1000-82540em,e1000-82545em,e1000-82544gc,xennet,nic_custom
only no_virtio_rng
only smp2
only no_9p_export
only no_pci_assignable
only (image_backend=filesystem)
only smallpages
smp = 32
vcpu_cores = 32
vcpu_threads = 1
vcpu_sockets = 1
# 32G
mem = 32768

variants:
    - guest_import:
        only unattended_install.import.import.default_install.aio_native

    - guest_storage:
        variants:
            - pool:
                only virsh.pool
                no virsh.pool.positive_test.pool_type_gluster #Not supported
                no virsh.pool.positive_test.pool_type_netfs.source_format_glusterfs #Not supported
                no virsh.pool.positive_test.pool_type_logical.source_format_auto #'vgscan --cache' failed (rc=5)
                no virsh.pool.positive_test.pool_type_logical.source_format_lvm2 #Needs Fix
                no virsh.pool.positive_test.pool_type_disk.source_format_dos #Need fix :poll for volume to list sdl1
                no virsh.pool.positive_test.pool_type_disk.source_format_dvh #Need fix :poll for volume to list sdl1
                no virsh.pool.positive_test.pool_type_disk.source_format_gpt #Need fix :poll for volume to list sdl1
                no virsh.pool.positive_test.pool_type_disk.source_format_mac #Need fix :poll for volume to list sdl1
                no virsh.pool.positive_test.pool_type_disk.source_format_bsd #Need fix :poll for volume to list sdl1
                no virsh.pool.positive_test.pool_type_disk.source_format_pc98#Need fix :poll for volume to list sdl1
                no virsh.pool.positive_test.pool_type_disk.source_format_sun #Need fix :poll for volume to list sdl1

            - pool_create:
                only virsh.pool_create
                no virsh.pool_create.positive_test.from_given_file # SKIP this requires a pool.xml to be passed manually to PASS
                no virsh.pool_create.positive_test.from_pre_def_pool.gluster_pool #SKIP missing gluster command Not supported

            - pool_create_as:
                only virsh.pool_create_as

            - pool_edit:
                only virsh.pool_edit
                no virsh.pool_edit.positive_test.name_option.gluster_pool.edit_redefine # Not supported
                no virsh.pool_edit.positive_test.uuid_option.gluster_pool.edit_redefine # Not supported

            - pool_acl:
                only virsh.pool_acl
                no virsh.pool_acl.positive_test.non_dir_pool.pool_type_logical #vgscan --cache' failed (rc=5)
                no virsh.pool_acl.positive_test.non_dir_pool.pool_type_disk

            - volume:
                only virsh.volume
                no virsh.volume.gluster_pool.vol_allocation.normal_size # Not supported
                no virsh.volume.gluster_pool.vol_allocation.zero_size # Not supported
                no virsh.volume.logical_pool.vol_allocation.normal_size #requires iscsi setup vgcreate failed
                no virsh.volume.logical_pool.vol_allocation.zero_size # requires iscsi setup vgcreate failed
                no virsh.volume.dir_pool.vol_encrypt_default.vol_format_qcow2.vol_allocation.normal_size # Raised encryption BUG
                no virsh.volume.dir_pool.vol_encrypt_default.vol_format_qcow2.vol_allocation.zero_size
                no virsh.volume.dir_pool.vol_encrypt_qcow.vol_format_qcow2.vol_allocation.normal_size
                no virsh.volume.dir_pool.vol_encrypt_qcow.vol_format_qcow2.vol_allocation.zero_size

            - vol_create_from:
                only virsh.vol_create_from
                no virsh.vol_create_from.positive_test..src_pool_type.disk
                no virsh.vol_create_from.positive_test..dest_pool_type.disk
                no virsh.vol_create_from.positive_test..dir.src_pool_type.fs
                no virsh.vol_create_from.positive_test..logical.src_pool_type.iscsi
                no virsh.vol_create_from.positive_test..logical.src_pool_type.scsi
                no virsh.vol_create_from.positive_test..dest_pool_type.logical
                no virsh.vol_create_from.positive_test..src_pool_type.logical #vgscan --cache' failed (rc=5)

            - domblkstat:
                only virsh.domblkstat

            - vol_create:
                only virsh.vol_create
                no virsh.vol_create.positive_test.disk_pool.vol_format_none.pool_format_none# Needs Fix partition not listed for volume
                no virsh.vol_create.positive_test.disk_pool.vol_format_none.pool_format_gpt
                no virsh.vol_create.positive_test.disk_pool.vol_format_linux.pool_format_none
                no virsh.vol_create.positive_test.disk_pool.vol_format_fat16.pool_format_none
                no virsh.vol_create.positive_test.disk_pool.vol_format_fat32.pool_format_none
                no virsh.vol_create.positive_test.disk_pool.vol_format_linux-swap.pool_format_none
                no virsh.vol_create.positive_test.disk_pool.vol_format_linux-lvm.pool_format_none
                no virsh.vol_create.positive_test.disk_pool.vol_format_linux-raid.pool_format_none
                no virsh.vol_create.positive_test.disk_pool.vol_format_extended.pool_format_none
                no virsh.vol_create.positive_test..v_raw.src_pool_type.netfs #Not supported
                no virsh.vol_create.positive_test..v_iso.src_pool_type.dir.non_acl #Needs Fix
                no virsh.vol_create.positive_test..v_iso.src_pool_type.dir.acl_test  #Needs Fix
                no virsh.vol_create.positive_test..v_iso.src_pool_type.fs #Needs Fix
                no virsh.vol_create.positive_test..v_iso.src_pool_type.netfs #Needs Fix
                no virsh.vol_create.positive_test.logical_pool.deactivate_vol #Needs Fix
                no virsh.vol_create.positive_test.logical_pool.incomplete_target #Needs Fix
                no virsh.vol_create.positive_test.logical_pool.normal_vol  #Needs Fix
                no virsh.vol_create.positive_test.logical_pool.snapshot_vol #Needs Fix
                no virsh.vol_create.positive_test.logical_pool.thin_vol  #bug 1060287
                no virsh.vol_create.create_as.by_name.positive_test.logical_pool.thin_vol #bug 1060287
                no virsh.vol_create.create_as.by_uuid.positive_test.logical_pool.thin_vol #bug 1060287
                no virsh.vol_create.create.positive_test.logical_pool.thin_vol #bug 1060287


            - vol_resize:
                only virsh.vol_resize
                no virsh.vol_resize.positive_test..allocate_capacity.netfs #vol resize check fail
                no virsh.vol_resize.positive_test..delta_allocate_capacity.netfs #Needs Fix

            - vol_download_upload:
                only virsh.vol_download_upload
                no virsh.vol_download_upload.download_upload.disk_pool..0-1024 # Needs fix
                no virsh.vol_download_upload.download_upload.disk_pool..1024-4096
                no virsh.vol_download_upload.download_upload.disk_pool..0-end
                no virsh.vol_download_upload.download_upload.disk_pool..1024-end
                no virsh.vol_download_upload.download_upload.disk_pool..no_options
                no virsh.vol_download_upload.download_upload.dir_pool..0-end
                no virsh.vol_download_upload.download_upload.dir_pool..1024-end
                no virsh.vol_download_upload.download_upload.dir_pool..no_options
                no virsh.vol_download_upload.download_upload.fs_pool..0-end
                no virsh.vol_download_upload.download_upload.fs_pool..1024-end
                no virsh.vol_download_upload.download_upload.fs_pool..no_options
                no virsh.vol_download_upload.download_upload.logical_pool..no_options
                no virsh.vol_download_upload.download_upload.logical_pool..1024-end
                no virsh.vol_download_upload.download_upload.netfs_pool..0-end
                no virsh.vol_download_upload.download_upload.netfs_pool..1024-end
                no virsh.vol_download_upload.download_upload.netfs_pool..no_options


            - vol_clone_wipe:
                only virsh.vol_clone_wipe
                no virsh.vol_clone_wipe.positive_test.non_acl.disk_part.pool_type.disk#test case needs fix no storage vol '/dev/sdn1 found
                no virsh.vol_clone_wipe.positive_test.acl_test.disk_part.pool_type.disk#test case needs fix no storage vol '/dev/sdn1 found

            - update_device_matrix:
                updatedevice_target_bus = "scsi"
                updatedevice_target_dev = "sdc"
                only virsh.update_device_matrix

            - attach_device:
                variants:
                    - non_block_virtio_file:
                        only virsh.attach_device
                        no virsh.attach_device.character
                        no virsh.attach_device.controller.type_scsi.normal_test.hot_attach_hot_vm # FAIL: TestFail: Positive operational test failed
                        no virsh.attach_device.controller.type_scsi.normal_test.hot_attach_hot_vm_current # FAIL: TestFail: Positive operational test failed
                        no virsh.attach_device.controller.type_scsi.normal_test.cold_attach_cold_vm # FAIL: TestFail: Positive operational test failed
                        no virsh.attach_device.controller.type_scsi.normal_test.cold_attach_hot_vm # FAIL: TestFail: Positive operational test failed
                        no virsh.attach_device.block.single_usb_file.normal_test.hot_attach_hot_vm # FAIL: TestFail: Positive operational test failed
                        no virsh.attach_device.block.single_usb_file.normal_test.hot_attach_hot_vm_current # FAIL: TestFail: Positive operational test failed
                        no virsh.attach_device.block.single_usb_file.normal_test.cold_attach_cold_vm # FAIL: TestFail: Positive operational test failed
                        no virsh.attach_device.block.single_usb_file.normal_test.cold_attach_hot_vm # FAIL: TestFail: Positive operational test failed
                        no virsh.attach_device.block.single_scsi_file.normal_test.hot_attach_hot_vm # FAIL: TestFail: Positive operational test failed
                        no virsh.attach_device.block.single_scsi_file.normal_test.hot_attach_hot_vm_current # FAIL: TestFail: Positive operational test failed
                        no virsh.attach_device.block.single_scsi_file.normal_test.cold_attach_cold_vm # FAIL: TestFail: Positive operational test failed
                        no virsh.attach_device.block.single_scsi_file.normal_test.cold_attach_hot_vm # FAIL: TestFail: Positive operational test failed
                        no virsh.attach_device.block.single_virtio_file.normal_test.hot_attach_hot_vm # FAIL :TestFail: Positive pre-boot functionality test failed
                        no virsh.attach_device.block.single_virtio_file.normal_test.hot_attach_hot_vm_current # FAIL :TestFail: Positive pre-boot functionality test failed
                        no virsh.attach_device.block.single_virtio_file.normal_test.cold_attach_cold_vm # FAIL: TestFail: Positive post-boot functionality test failed
                        no virsh.attach_device.block.single_virtio_file.normal_test.cold_attach_hot_vm # FAIL: TestFail: Positive post-boot functionality test failed
                        no virsh.attach_device.multiple.VirtualDiskBasic_SerialFile_SerialPipe.normal_test.cold_attach_cold_vm # FAIL: TestFail: Positive post-boot functionality test failed
                        no virsh.attach_device.multiple.VirtualDiskBasic_SerialFile_SerialPipe.normal_test.cold_attach_hot_vm # FAIL: TestFail: Positive post-boot functionality test failed
                        no virsh.attach_device.character.console.type_pty.normal_test.cold_attach_cold_vm # FAIL : TestFail: VM Failed to start for some reason!
                        no virsh.attach_device.character.channel.type_pty.normal_test.cold_attach_hot_vm # FAIL : TestFail: VM Failed to start for some reason!
                        no virsh.attach_device.character.console.type_pty.normal_test.cold_attach_hot_vm # FAIL : TestFail: VM Failed to start for some reason!
                        no virsh.attach_device.character.channel.type_pty.normal_test.cold_attach_cold_vm # FAIL : TestFail: VM Failed to start for some reason!
                        no virsh.attach_device.character.channel.type_pty.normal_test.cold_attach_hot_vm # FAIL : TestFail: VM Failed to start for some reason!
                        no virsh.attach_device.block.multi_virtio_file # ERROR - KeyError: VirtIODiskBasic

                    - block_virtio_file:
                        vadu_dev_obj_devidx_VirtualDiskBasic = 0
                        only virsh.attach_device.block.single_virtio_file.normal_test

            - attach_device_matrix:
                only virsh.attach_device_matrix

            - libvirt_scsi:
                only libvirt_scsi.disk_type_cdrom, libvirt_scsi.disk_type_img, libvirt_scsi.disk_type_partition, libvirt_scsi.multi_disk_type
                no libvirt_scsi.disk_type_cdrom # Fails to start
                no libvirt_scsi.disk_type_partition #partition not configured
                no libvirt_scsi.multi_disk_type #partition not configured

            - attach_detach_disk_matrix:
                at_dt_disk_bus_type = "scsi"
                at_dt_disk_device_target = "sdc"
                only virsh.attach_detach_disk_matrix

            - attach_detach_disk:
                variants:
                    - virtio:
                        at_dt_disk_device_target = "vdc"
                        at_dt_disk_bus_type = "virtio"
                        only virsh.attach_detach_disk
                        no virsh.attach_detach_disk..error_test.invalid_target
                        no virsh.attach_detach_disk.detach_disk.normal_test.vm_suspend
                        no virsh.attach_detach_disk.attach_disk.error_test.only_attach_disk.ide_bus # N/A
                        no virsh.attach_detach_disk.attach_disk.normal_test.cdrom_eject_control # N/A
                        no virsh.attach_detach_disk..normal_test.cdrom # N/A
                        no virsh.attach_detach_disk.attach_disk.normal_test.attach_disk_type.block_disk_type_lun # virtio-scsi
                        no virsh.attach_detach_disk.attach_disk.normal_test.twice_multifunction # Needs fix

                    - vm_suspend:
                        time_sleep = 5
                        only virsh.attach_detach_disk.detach_disk.normal_test.vm_suspend

                    - invalid_target:
                        only virsh.attach_detach_disk..error_test.invalid_target

# Working on validating
#            - volume_application: Test case needs fix
#                only virsh.volume_application
#
#            - domfstrim:
#                no virsh.domfstrim #Needs Fix
#
#            - virtual_disks:
#                only virtual_disks.at_dt_iscsi_disk, virtual_disks.encryption, virtual_disks.gluster, virtual_disks.iscsi, virtual_disks.multidisks, virtual_disks.multivms
#
#            - virt_xml_validate:
#                only libvirt.virt_xml_validate.storagepool
#                only libvirt.virt_xml_validate.storagevol

    - guest_remove:
        only remove_guest.without_disk
